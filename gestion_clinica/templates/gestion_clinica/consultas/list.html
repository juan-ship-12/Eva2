{% extends 'gestion_clinica/base.html' %}

{% block title %}Consultas - Salud Vital{% endblock %}

{% block header_title %}Consultas M√©dicas{% endblock %}

{% block content %}
<div class="card">
    <h2>üìã Gesti√≥n de Consultas</h2>
    <p>Administra las consultas m√©dicas y su estado.</p>
    
    <div style="margin-top: 16px;">
        <a href="{% url 'home' %}" class="btn btn-secondary">‚Üê Volver al Inicio</a>
        <a href="{% url 'consulta-create' %}" class="btn btn-primary">+ Agregar Consulta</a>
        <a href="/swagger/" class="btn btn-secondary" target="_blank">Ver API Docs</a>
    </div>
</div>

<div class="card">
    <h2>Lista de Consultas</h2>
    <p>Consultas m√©dicas registradas en el sistema.</p>
    
    <table class="table">
        <thead>
            <tr>
                <th>Paciente</th>
                <th>M√©dico</th>
                <th>Fecha</th>
                <th>Motivo</th>
                <th>Estado</th>
                <th>Diagn√≥stico</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% if consultas %}
                {% for consulta in consultas %}
                <tr>
                    <td>{{ consulta.paciente.nombre }} {{ consulta.paciente.apellido }}</td>
                    <td>{{ consulta.medico.nombre }} {{ consulta.medico.apellido }}</td>
                    <td>{{ consulta.fecha_consulta|date:"d/m/Y H:i" }}</td>
                    <td>{{ consulta.motivo }}</td>
                    <td>
                        <span style="color: {% if consulta.estado == 'COMPLETADA' %}#2da44e{% elif consulta.estado == 'AGENDADA' %}#0366d6{% elif consulta.estado == 'CANCELADA' %}#d73a49{% else %}#f66a0a{% endif %};">
                            {{ consulta.get_estado_display }}
                        </span>
                    </td>
                    <td>{{ consulta.diagnostico|truncatechars:50 }}</td>
                    <td>
                        <a href="{% url 'consulta-edit' consulta.id %}" class="btn btn-secondary" style="margin-right: 8px; text-decoration: none;">Editar</a>
                        <a href="{% url 'consulta-delete' consulta.id %}" class="btn" style="background-color: #d73a49; color: white; text-decoration: none;">Eliminar</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="7" style="text-align: center; color: #656d76; padding: 24px;">
                        <p>No hay consultas registradas a√∫n.</p>
                        <p style="font-size: 12px; margin-top: 8px;">
                            Usa la API para agregar consultas o el panel de administraci√≥n de Django.
                        </p>
                    </td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<div class="card">
    <h2>Estados de Consulta</h2>
    <p>Los estados disponibles para las consultas son:</p>
    
    <div style="background: #f6f8fa; padding: 16px; border-radius: 6px; margin-top: 16px;">
        <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 8px;"><strong>üü° Agendada:</strong> Consulta programada</li>
            <li style="margin-bottom: 8px;"><strong>üîµ En Curso:</strong> Consulta en progreso</li>
            <li style="margin-bottom: 8px;"><strong>üü¢ Completada:</strong> Consulta finalizada</li>
            <li style="margin-bottom: 8px;"><strong>üî¥ Cancelada:</strong> Consulta cancelada</li>
            <li style="margin-bottom: 8px;"><strong>‚ö´ No Asisti√≥:</strong> Paciente no se present√≥</li>
        </ul>
    </div>
</div>

<div class="card">
    <h2>Informaci√≥n de la API</h2>
    <p>Endpoints disponibles para la gesti√≥n de consultas:</p>
    
    <div style="background: #f6f8fa; padding: 16px; border-radius: 6px; margin-top: 16px;">
        <h3 style="margin-bottom: 8px;">Endpoints disponibles:</h3>
        <ul style="list-style: none; padding: 0;">
            <li style="margin-bottom: 4px;"><code>GET /api/consultas/</code> - Listar todas las consultas</li>
            <li style="margin-bottom: 4px;"><code>POST /api/consultas/</code> - Crear una nueva consulta</li>
            <li style="margin-bottom: 4px;"><code>GET /api/consultas/{id}/</code> - Obtener una consulta espec√≠fica</li>
            <li style="margin-bottom: 4px;"><code>PUT /api/consultas/{id}/</code> - Actualizar una consulta</li>
            <li style="margin-bottom: 4px;"><code>DELETE /api/consultas/{id}/</code> - Eliminar una consulta</li>
        </ul>
    </div>
</div>
{% endblock %}
