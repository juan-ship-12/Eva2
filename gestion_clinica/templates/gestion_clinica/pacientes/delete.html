{% extends 'gestion_clinica/base.html' %}

{% block title %}Eliminar Paciente - Salud Vital{% endblock %}

{% block header_title %}Eliminar Paciente{% endblock %}

{% block content %}
<div class="card">
    <h2>‚ö†Ô∏è Confirmar Eliminaci√≥n</h2>
    <p>¬øEst√° seguro de que desea eliminar este paciente del sistema?</p>
    
    <div style="margin-top: 16px;">
        <a href="{% url 'paciente-list' %}" class="btn btn-secondary">‚Üê Volver a Pacientes</a>
    </div>
</div>

<div class="card">
    <h2>Datos del Paciente a Eliminar</h2>
    
    <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; padding: 16px; margin-bottom: 20px;">
        <h3 style="color: #856404; margin: 0 0 12px 0;">‚ö†Ô∏è Advertencia</h3>
        <p style="color: #856404; margin: 0;">Esta acci√≥n no se puede deshacer. Se eliminar√°n todos los datos relacionados con este paciente.</p>
    </div>
    
    <div style="background: #f6f8fa; border: 1px solid #d0d7de; border-radius: 6px; padding: 20px; margin-bottom: 20px;">
        <h3 style="margin: 0 0 16px 0; color: #24292f;">Informaci√≥n del Paciente</h3>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
            <div>
                <strong>Nombre:</strong> {{ paciente.nombre }} {{ paciente.apellido }}
            </div>
            <div>
                <strong>RUT:</strong> {{ paciente.rut }}
            </div>
            <div>
                <strong>Fecha de Nacimiento:</strong> {{ paciente.fecha_nacimiento|date:"d/m/Y" }}
            </div>
            <div>
                <strong>Tel√©fono:</strong> {{ paciente.telefono }}
            </div>
            <div>
                <strong>Correo:</strong> {{ paciente.correo }}
            </div>
            <div>
                <strong>Direcci√≥n:</strong> {{ paciente.direccion }}
            </div>
            <div>
                <strong>Tipo de Sangre:</strong> {{ paciente.get_tipo_sangre_display }}
            </div>
        </div>
    </div>
    
    <form method="POST" id="deleteForm" style="margin-top: 20px;">
        {% csrf_token %}
        
        <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button type="button" id="deleteBtn" class="btn" style="background: #d73a49; color: white; border: none; padding: 12px 24px; border-radius: 6px; font-weight: 600;">
                üóëÔ∏è Eliminar Paciente
            </button>
            <a href="{% url 'paciente-list' %}" class="btn btn-secondary" style="background: #f6f8fa; color: #24292f; border: 1px solid #d0d7de; padding: 12px 24px; border-radius: 6px; text-decoration: none;">
                ‚ùå Cancelar
            </a>
        </div>
    </form>
</div>

{% if messages %}
    {% for message in messages %}
        <div style="background: #d1ecf1; color: #0c5460; padding: 12px; border-radius: 6px; margin-top: 16px; border: 1px solid #bee5eb;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<script>
document.getElementById('deleteBtn').addEventListener('click', function() {
    Swal.fire({
        title: '¬øEst√°s seguro?',
        text: 'Esta acci√≥n no se puede deshacer. Se eliminar√° permanentemente el paciente {{ paciente.nombre }} {{ paciente.apellido }}.',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d73a49',
        cancelButtonColor: '#6c757d',
        confirmButtonText: 'S√≠, eliminar',
        cancelButtonText: 'Cancelar',
        reverseButtons: true
    }).then((result) => {
        if (result.isConfirmed) {
            // Mostrar loading
            Swal.fire({
                title: 'Eliminando...',
                text: 'Por favor espera',
                allowOutsideClick: false,
                showConfirmButton: false,
                willOpen: () => {
                    Swal.showLoading()
                }
            });
            
            // Enviar formulario
            document.getElementById('deleteForm').submit();
        }
    });
});
</script>
{% endblock %}
