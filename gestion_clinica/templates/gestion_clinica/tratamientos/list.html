{% extends 'gestion_clinica/base.html' %}

{% block title %}Tratamientos - Salud Vital{% endblock %}

{% block header_title %}Tratamientos{% endblock %}

{% block content %}
<div class="card">
    <h2>ü©∫ Gesti√≥n de Tratamientos</h2>
    <p>Administra los tratamientos m√©dicos del sistema.</p>
    
    <div style="margin-top: 16px;">
        <a href="{% url 'home' %}" class="btn btn-secondary">‚Üê Volver al Inicio</a>
        <a href="{% url 'tratamiento-create' %}" class="btn btn-primary">+ Agregar Tratamiento</a>
        <a href="/swagger/" class="btn btn-secondary" target="_blank">Ver API Docs</a>
    </div>
</div>

<div class="card">
    <h2>Lista de Tratamientos</h2>
    <p>Tratamientos m√©dicos registrados en el sistema.</p>
    
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Consulta</th>
                <th>Paciente</th>
                <th>M√©dico</th>
                <th>Descripci√≥n</th>
                <th>Duraci√≥n (d√≠as)</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% if tratamientos %}
                {% for tratamiento in tratamientos %}
                <tr>
                    <td>{{ tratamiento.id }}</td>
                    <td>{{ tratamiento.consulta.motivo|truncatechars:30 }}</td>
                    <td>{{ tratamiento.consulta.paciente.nombre }} {{ tratamiento.consulta.paciente.apellido }}</td>
                    <td>{{ tratamiento.consulta.medico.nombre }} {{ tratamiento.consulta.medico.apellido }}</td>
                    <td>{{ tratamiento.descripcion|truncatechars:50 }}</td>
                    <td>{{ tratamiento.duracion_dias }}</td>
                    <td>
                        <a href="{% url 'tratamiento-edit' tratamiento.id %}" class="btn btn-secondary" style="margin-right: 8px; text-decoration: none;">Editar</a>
                        <a href="{% url 'tratamiento-delete' tratamiento.id %}" class="btn" style="background-color: #d73a49; color: white; text-decoration: none;">Eliminar</a>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="7" style="text-align: center; color: #656d76; padding: 24px;">
                        <p>No hay tratamientos registrados a√∫n.</p>
                        <p style="font-size: 12px; margin-top: 8px;">
                            Haz clic en "Agregar Tratamiento" para crear el primero.
                        </p>
                    </td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<div class="card">
    <h2>Informaci√≥n de la API</h2>
    <p>Endpoints disponibles para la gesti√≥n de tratamientos:</p>
    
    <div style="background: #f6f8fa; padding: 16px; border-radius: 6px; margin-top: 16px;">
        <h3 style="margin-bottom: 16px;">üîó Endpoints Interactivos:</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 12px;">
            <a href="/api/tratamientos/" class="btn btn-primary" target="_blank" style="text-decoration: none; display: block; padding: 12px; border-radius: 6px; background: #2da44e; color: white; text-align: center;">
                <strong>GET /api/tratamientos/</strong><br>
                <small>Listar todos los tratamientos</small>
            </a>
            <a href="/swagger/" class="btn btn-secondary" target="_blank" style="text-decoration: none; display: block; padding: 12px; border-radius: 6px; background: #f6f8fa; color: #24292f; text-align: center; border: 1px solid #d0d7de;">
                <strong>POST /api/tratamientos/</strong><br>
                <small>Crear nuevo tratamiento (Swagger)</small>
            </a>
            <a href="/swagger/" class="btn btn-secondary" target="_blank" style="text-decoration: none; display: block; padding: 12px; border-radius: 6px; background: #f6f8fa; color: #24292f; text-align: center; border: 1px solid #d0d7de;">
                <strong>PUT/DELETE /api/tratamientos/{id}/</strong><br>
                <small>Actualizar/Eliminar (Swagger)</small>
            </a>
        </div>
    </div>
</div>

<script>
function agregarTratamiento() {
    window.open('/swagger/', '_blank');
}

function editarTratamiento(id) {
    window.open('/swagger/', '_blank');
}

function eliminarTratamiento(id) {
    if (confirm('¬øEst√°s seguro de que quieres eliminar este tratamiento?')) {
        alert('Funcionalidad de eliminaci√≥n en desarrollo. Usa Swagger por ahora.');
    }
}
</script>
{% endblock %}
